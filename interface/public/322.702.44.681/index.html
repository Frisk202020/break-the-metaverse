<!DOCTYPE html>
<html>
    <head>
        <title>Trial</title>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=360,keyboard_arrow_down,keyboard_arrow_left,keyboard_arrow_right,keyboard_arrow_up" />
    </head>
    <body>
        <div id="main">
            <p id="text">Suivez l'itin√©raire blanc...</p>
            <span id="up" class="material-symbols-outlined">keyboard_arrow_up</span>
            <div>
                <span id="left" class="material-symbols-outlined">keyboard_arrow_left</span>
                <span id="down" class="material-symbols-outlined">keyboard_arrow_down</span>
                <span id="right" class="material-symbols-outlined">keyboard_arrow_right</span>
            </div>
            <span id="rotate" class="material-symbols-outlined">360</span>
        </div>
        <div id="bg"></div>
        <div id="holy"></div>
    </body>
    <style>
        .material-symbols-outlined {
            font-size: 80px;
        }
        #main {
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            z-index: 2;
        } #bg {
            background-image: url("./bg.png");
            background-position: center;
            background-size: cover;
            opacity: .7;
        } #main,#bg {
            width: 100vw; height: 100vh;
            position: fixed; top: 0; left: 0;
        }
        span {
            border: solid 3px;
            border-radius: 10px;
            margin: 50px;
            background-color: #f4ecbd;
        } span:hover {
            cursor: pointer;
            background-color: #f3e7a8;
        } p {
            font-size: 50px;
            font-style: italic;
        }
        .holy {
            width: 0vw; height: 0vw;
            background-image: linear-gradient(to top right, #ff0000 30%, #00ff00 50%, #0000ff);
            animation: holy-grow 3s forwards, holy-color 3s forwards;
            position: absolute;
            left: 50%; top: 50%;
            z-index: 3;
            border-radius: 100%;
        }
        
        @keyframes holy-grow {
            0% {height: 0vh; width: 0vw;}
            100% {height: 150vw; width: 150vw; left: -25%; top: -75%}
        } @keyframes holy-color {
            to { transform: rotate(720deg); }
        }
    </style>
    <script>
        const KEYS = {
            UP: "up",
            LEFT: "left",
            DOWN: "down",
            RIGHT: "right",
            ROTATE: "rotate"
        }; 
        const solution = [
            KEYS.RIGHT, KEYS.DOWN, KEYS.DOWN, KEYS.DOWN, KEYS.DOWN,
            KEYS.LEFT, KEYS.UP, KEYS.ROTATE, KEYS.RIGHT, KEYS.LEFT,
            KEYS.UP, KEYS.UP, KEYS.ROTATE, KEYS.DOWN, KEYS.ROTATE,
            KEYS.RIGHT
        ];
        const ANIM_T = 3000;
        const IP_PIECE = 74;
        let index = 0;

        function handler(key) {
            if (key === solution[index]) {
                index++;
                if (index === solution.length) {
                    resolve();
                }
            } else {
                index = 0;
            }
        } function resolve() {
            holy.className = "holy";
            new Audio("./sfx.mp3").play();
            new Promise((r)=>setTimeout(r, ANIM_T)).then(()=>{
                text.textContent = "X.X.X." + IP_PIECE;
                bg.style.backgroundImage = 'url("./resolved.png")';
                document.body.removeChild(holy);
            });
        }

        const btns = [KEYS.UP, KEYS.LEFT, KEYS.DOWN, KEYS.RIGHT, KEYS.ROTATE].map((x)=>{
            const elm = document.getElementById(x);
            elm.onclick = ()=>handler(x);
            return elm;
        });
        const text = document.getElementById("text");
        const bg = document.getElementById("bg");
        const holy = document.getElementById("holy");
    </script>
</html>